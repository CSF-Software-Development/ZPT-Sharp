<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Nothing</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProjectGuid>{28D30A8C-0693-4FEA-BCC7-020AA41ECBB1}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AssemblyName>Documentation</AssemblyName>
    <WebsiteUrlRoot>http://csf-dev.github.io/ZPT-Sharp/</WebsiteUrlRoot>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <DoxygenConfig>Doxygen.cfg</DoxygenConfig>
    <WebsiteSource>Website</WebsiteSource>
    <BuildRoot>obj\Release</BuildRoot>
    <DoxygenOutput>$(BuildRoot)\Doxygen-output</DoxygenOutput>
    <LatexPath>$(DoxygenOutput)\latex</LatexPath>
    <LatexOutput>refman.tex</LatexOutput>
    <PdfOutput>refman.pdf</PdfOutput>
    <PdfFilename>ZPT-Sharp API documentation.pdf</PdfFilename>
    <AssembledApiDocsPath>$(DoxygenOutput)\html</AssembledApiDocsPath>
    <AssembledOutputPath>bin\Release</AssembledOutputPath>
    <BuiltWebsitePath>$(BuildRoot)\Doc-website</BuiltWebsitePath>
    <PreBuiltWebsitePath>$(BuildRoot)\Website-build</PreBuiltWebsitePath>
    <IgnoredDir>$(PreBuiltWebsitePath)\Shared</IgnoredDir>
    <AssembledWebsitePath>$(AssembledOutputPath)\Website</AssembledWebsitePath>
    <ApiDocsOutputPath>$(AssembledWebsitePath)\api</ApiDocsOutputPath>
    <ZptBuilderHtmlDocs>..\..\CSF.Zpt.Cli\bin\Release\Doc\ZptBuilder.html</ZptBuilderHtmlDocs>
    <ZptBuilderPath>..\..\CSF.Zpt.Cli\bin\Release\ZptBuilder.exe</ZptBuilderPath>
    <BuildTimestamp>$([System.DateTime]::Now.ToString(yyyy-MM-dd))</BuildTimestamp>
    <CopyrightYear>$([System.DateTime]::Now.ToString(yyyy))</CopyrightYear>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Nothing|AnyCPU' ">
    <ConsolePause>false</ConsolePause>
    <OutputPath>bin\Nothing</OutputPath>
    <WarningLevel>4</WarningLevel>
    <Optimize>false</Optimize>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <Optimize>false</Optimize>
    <OutputPath>bin\Release</OutputPath>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <ConsolePause>false</ConsolePause>
  </PropertyGroup>
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
  <UsingTask TaskName="FixDocTag" AssemblyFile="bin\Release\CSF.Zpt.DeploymentTasks.dll" />
  <UsingTask TaskName="ReadVersionNumber" AssemblyFile="..\CSF.Zpt.DeploymentTasks\bin\$(Configuration)\CSF.Zpt.DeploymentTasks.dll" />
  <Target Name="BuildApiDocumentation">
    <ReadVersionNumber VersionFile="..\..\version.ini">
      <Output TaskParameter="FullVersionNumber" ItemName="FullVersion" />
      <Output TaskParameter="SemanticVersionNumber" ItemName="SemanticVersion" />
      <Output TaskParameter="BuildNumber" ItemName="BuildNumber" />
      <Output TaskParameter="InformationalVersion" ItemName="InformationalVersion" />
    </ReadVersionNumber>
    <RemoveDir Directories="$(DoxygenOutput)" />
    <MakeDir Directories="$(DoxygenOutput)" />
    <Exec Command="( cat $(DoxygenConfig) ; echo 'PROJECT_NUMBER=v@(SemanticVersion)' ) | doxygen -" Condition="'$(OS)' == 'Unix'" />
    <Exec Command="( type $(DoxygenConfig) &amp; echo PROJECT_NUMBER=v@(SemanticVersion) ) | doxygen.exe -" Condition="'$(OS)' != 'Unix'" />
    <Exec Command="pdflatex $(LatexOutput)" WorkingDirectory="$(LatexPath)" />
    <Copy SourceFiles="$(LatexPath)\$(PdfOutput)" DestinationFiles="$(DoxygenOutput)\$(PdfFilename)" />
  </Target>
  <Target Name="BuildDocumentationWebsite">
    <ReadVersionNumber VersionFile="..\..\version.ini">
      <Output TaskParameter="FullVersionNumber" ItemName="FullVersion" />
      <Output TaskParameter="SemanticVersionNumber" ItemName="SemanticVersion" />
      <Output TaskParameter="BuildNumber" ItemName="BuildNumber" />
      <Output TaskParameter="InformationalVersion" ItemName="InformationalVersion" />
    </ReadVersionNumber>
    <RemoveDir Directories="$(PreBuiltWebsitePath);$(BuiltWebsitePath)" />
    <MakeDir Directories="$(PreBuiltWebsitePath);$(BuiltWebsitePath)" />
    <ItemGroup>
      <WebsiteSourceFiles Include="$(WebsiteSource)\**\*.*" />
    </ItemGroup>
    <Copy SourceFiles="@(WebsiteSourceFiles)" DestinationFiles="@(WebsiteSourceFiles-&gt;'$(PreBuiltWebsitePath)\%(RecursiveDir)%(Filename)%(Extension)')" />
    <Copy SourceFiles="$(ZptBuilderHtmlDocs)" DestinationFiles="$(PreBuiltWebsitePath)\Shared\cli-docs.html" />
    <ItemGroup>
      <WebsiteSupportFiles Include="$(PreBuiltWebsitePath)\**\*.css" />
      <WebsiteSupportFiles Include="$(PreBuiltWebsitePath)\**\*.js" />
    </ItemGroup>
    <FixDocTag InputFile="$(PreBuiltWebsitePath)\Shared\cli-docs.html" MacroName="content" />
    <Exec Command="$(ZptBuilderPath) &quot;$(PreBuiltWebsitePath)&quot; -p &quot;*.html&quot; -o &quot;$(BuiltWebsitePath)&quot; -i &quot;$(IgnoredDir)&quot; --keyword-options &quot;baseUrl=$(WebsiteUrlRoot);buildDate=$(BuildTimestamp);version=@(SemanticVersion);releaseType=@(InformationalVersion);copyrightYear=$(CopyrightYear)&quot;" />
    <Copy SourceFiles="@(WebsiteSupportFiles)" DestinationFiles="@(WebsiteSupportFiles-&gt;'$(BuiltWebsitePath)\%(RecursiveDir)%(Filename)%(Extension)')" />
  </Target>
  <Target Name="AssembleAllDocumentation">
    <RemoveDir Directories="$(AssembledOutputPath)" />
    <MakeDir Directories="$(AssembledWebsitePath)" />
    <ItemGroup>
      <WebsiteFiles Include="$(BuiltWebsitePath)\**\*.*" />
    </ItemGroup>
    <ItemGroup>
      <DoxygenOutputFiles Include="$(AssembledApiDocsPath)\**\*.*" />
    </ItemGroup>
    <Copy SourceFiles="@(WebsiteFiles)" DestinationFiles="@(WebsiteFiles-&gt;'$(AssembledWebsitePath)\%(RecursiveDir)%(Filename)%(Extension)')" />
    <Copy SourceFiles="@(DoxygenOutputFiles)" DestinationFiles="@(DoxygenOutputFiles-&gt;'$(ApiDocsOutputPath)\%(RecursiveDir)%(Filename)%(Extension)')" />
    <Copy SourceFiles="$(DoxygenOutput)\$(PdfFilename)" DestinationFolder="$(AssembledOutputPath)" />
  </Target>
  <Target Name="AfterBuild">
    <CallTarget Targets="BuildApiDocumentation" Condition="'$(Configuration)' == 'Release'" />
    <CallTarget Targets="BuildDocumentationWebsite" Condition="'$(Configuration)' == 'Release'" />
    <CallTarget Targets="AssembleAllDocumentation" Condition="'$(Configuration)' == 'Release'" />
  </Target>
  <ItemGroup>
    <None Include="Website\advantages-of-zpt-views.html" />
    <None Include="Website\asp-net-mvc-view-engine.html" />
    <None Include="Website\command-line-renderer.html" />
    <None Include="Website\download.html" />
    <None Include="Website\index.html" />
    <None Include="Website\page-rendering-api.html" />
    <None Include="Website\writing-pages-using-zpt.html" />
    <None Include="Website\Shared\empty-page.html" />
    <None Include="Website\Shared\general-page.html" />
    <None Include="Website\Shared\navigation.html" />
    <None Include="Website\css\command_line_renderer.css" />
    <None Include="Website\css\content.css" />
    <None Include="Website\css\dummy.css" />
    <None Include="Website\css\introduction.css" />
    <None Include="Website\css\page.css" />
    <None Include="Website\css\reset.css" />
    <None Include="Website\css\styles.css" />
    <None Include="Website\css\tal_content_or_replace.css" />
    <None Include="Website\metal\define-fill-slot.html" />
    <None Include="Website\metal\define-use-macro.html" />
    <None Include="Website\metal\extend-macro.html" />
    <None Include="Website\metal\introduction.html" />
    <None Include="Website\tal\attributes.html" />
    <None Include="Website\tal\condition.html" />
    <None Include="Website\tal\content-replace.html" />
    <None Include="Website\tal\define.html" />
    <None Include="Website\tal\introduction.html" />
    <None Include="Website\tal\omit-tag.html" />
    <None Include="Website\tal\on-error.html" />
    <None Include="Website\tal\repeat.html" />
    <None Include="Website\tales\boolean-coercion.html" />
    <None Include="Website\tales\built-in-variables.html" />
    <None Include="Website\tales\cancellation.html" />
    <None Include="Website\tales\introduction.html" />
    <None Include="Website\tales\not-expressions.html" />
    <None Include="Website\tales\path-expressions.html" />
    <None Include="Website\tales\repeat-variables.html" />
    <None Include="Website\tales\string-expressions.html" />
    <None Include="Doxygen.cfg" />
    <None Include="Website style guide.txt" />
    <None Include="Website\Shared\cli-docs.html" />
    <None Include="Website\css\download.css" />
    <None Include="Website\js\lib\modernizr.min.js" />
    <None Include="Website\js\lib\require.min.js" />
    <None Include="Website\js\config\main.js" />
    <None Include="Website\js\app.js" />
    <None Include="Website\js\highlightCodeBlocks.js" />
    <None Include="Website\js\navigationMenu.js" />
    <None Include="Website\logging.html" />
    <None Include="Website\plugins.html" />
    <None Include="Website\js\pageDetector.js" />
    <None Include="Website\js\config\pageScriptRegistry.js" />
    <None Include="Website\js\pages\introduction.js" />
    <None Include="Website\configuration.html" />
    <None Include="Website\Shared\plugin_note.html" />
    <None Include="WebsiteKeywordOptions.txt" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\CSF.Zpt.Cli\CSF.Zpt.Cli.csproj">
      <Project>{4DD64666-DBEF-4AD5-BDB0-3EB3C70A6E83}</Project>
      <Name>CSF.Zpt.Cli</Name>
    </ProjectReference>
    <ProjectReference Include="..\CSF.Zpt.DeploymentTasks\CSF.Zpt.DeploymentTasks.csproj">
      <Project>{3E1DAACE-519B-4C6C-80E3-3F06A1A33C66}</Project>
      <Name>CSF.Zpt.DeploymentTasks</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Stub.cs" />
  </ItemGroup>
</Project>